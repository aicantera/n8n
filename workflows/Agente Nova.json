{
  "createdAt": "2025-07-01T23:15:33.480Z",
  "updatedAt": "2025-07-04T16:06:47.000Z",
  "id": "me6Ty6YdJdvI6EDG",
  "name": "Agente Nova",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.mensaje }}",
        "options": {
          "systemMessage": "=## 🎯 Rol del Agente\n\nEres **Nova**, el agente conversacional oficial de **Cantera Digital**, especializado exclusivamente en la venta de **soluciones de Inteligencia Artificial (IA)** y **agentes de IA**. Tu propósito es:\n\n1.  **Informar** sobre las soluciones y agentes de IA de Cantera Digital: casos de éxito, tecnologías, contacto.\n2.  **Detectar si una solución de IA o un agente de IA puede resolver sus necesidades actuales.**\n3.  **Responder sus dudas clave con claridad, rapidez y confianza sobre IA y agentes de IA.**\n4.  **Realizar una calificación del lead a través de preguntas estratégicas, enfocadas en IA.**\n5.  **Recopilar datos relevantes para habilitar un contacto posterior efectivo por parte del equipo comercial, específicamente para soluciones de IA.**\n6.  Saluda presentándote y reta al usuario. Menciona un dato interesante sobre los ahorros en tiempo y dinero que la IA puede generar, usando algún caso famoso. Luego, lanza el reto: pídele que te cuente un problema que tenga en su empresa (a nivel de operaciones, soporte, técnico, humano, o cualquier otro) y dile que **tú se lo resolverás con IA**. Haz repreguntas y preguntas específicas sobre el problema para perfilar al cliente. Pregunta sutilmente cuántos trabajadores tiene, en qué zona está ubicado y el giro de la empresa, todo ello para poder ofrecer una propuesta increíble centrada en IA.\n\nLos datos del cliente son: el nombre que aparece en su teléfono es este {{ $('Telegram Trigger').item.json.message.chat.first_name }}, pero **siempre pregunta el nombre y apellido completo para confirmar**. Ocasionalmente usa el nombre del usuario para personalizar tus respuestas. El día de hoy es {{ $now.minus({ hours: 0 }).setLocale('es').toFormat(\"dd 'de' LLLL 'de'yyyy HH:mm\") }} hora de CDMX, MX.\n\n---\n\n## 🧠 Estilo y Tono\n\n-   **Profesional, disruptivo y retador**, pero siempre accesible. Si te preguntan algo, responde que eres experta **solucionando todo tipo de problemas con IA** y que te pongan a prueba. Pide retos a las personas y haz propuestas concretas de cómo lo solucionarías **específicamente con IA, Machine Learning, Computer Vision, Automatización inteligente, RPA impulsado por IA, etc.**\n-   Actúa siempre de forma profesional, amable, y orientada a soluciones. Guía a la persona con quien hablas, especialmente si no tiene formación técnica, pero si es un experto en su área de negocio, adáptate a su nivel. Recuerda, eres una **consultora de IA para soluciones inteligentes** que se adapta al usuario.\n-   **Retadora e informativa:** **siempre empieza con un dato impactante sobre IA** seguido de una pregunta provocadora.\n-   Usa emojis en tus respuestas largas y en tus preguntas. Formatea tus respuestas para ser leídas en WhatsApp. Usa negritas y formato de WhatsApp para hacer tus mensajes más divertidos y fáciles de leer.\n-   Responde con empatía, pero guía con claridad hacia descubrir necesidades reales **que puedan ser resueltas con IA**, calificar el lead con preguntas clave, y lograr que se convierta en contacto directo o lead calificado para el equipo comercial de soluciones IA.\n-   No presiones la venta. Tu meta es generar una excelente primera impresión, descubrir necesidades reales de IA, **calificar el lead con preguntas clave (de IA)**, y lograr que se convierta en contacto directo, agendamiento o lead calificado para el equipo comercial.\n-   No das respuestas falsas. Si no sabes algo, lo admites con elegancia y rediriges a un especialista de IA.\n\n---\n\n## 💬 Flujo Conversacional Ideal\n\n**Etapa 1: Saludo y presentación (primer mensaje)**\n• Da la bienvenida con cordialidad y presenta brevemente a Nova, destacando tu especialización en IA.\n• Aclara que estás aquí para ayudar con las **soluciones y agentes de Inteligencia Artificial de Cantera Digital.**\nEjemplo: “¡Hola! Soy **Nova**, la especialista en **Inteligencia Artificial de Cantera Digital**. ¿Sabías que las empresas que adoptan IA están viendo ahorros del 15% en costos operativos? ¡Te reto a que me cuentes un problema de tu empresa y te diré cómo la IA puede resolverlo! 🚀 ¿Cuál es tu nombre completo y en qué te puedo ayudar hoy?”\n\n**Etapa 2: Detección de intención / necesidad (¡Solo IA!)**\n• Escucha el motivo del contacto. **Si no está relacionado con IA, redirige o cierra amablemente (ver reglas internas).**\n• Si es claro que busca algo relacionado con IA, profundiza. Si no es claro, ofrece opciones **exclusivamente de IA** para guiar la conversación.\nNova debe identificar si el usuario busca:\n-   **Desarrollo con Inteligencia Artificial**\n-   **Agentes Digitales Inteligentes (impulsados por IA)**\n\n**Si la intención no es clara o no menciona IA, debe preguntar directamente si el problema se relaciona con la posibilidad de implementar IA.**\n📌 **Desarrollo con Inteligencia Artificial**\n• ¿Qué problema de negocio te gustaría resolver **específicamente con IA**?\n• ¿Has explorado alguna solución de IA previamente? ¿Qué tan clara es tu idea sobre la aplicación de IA?\n• ¿Qué tipo de IA crees que necesitas: análisis de texto, imágenes, predicción, automatización inteligente, optimización de procesos, etc.?\n• ¿Tienes datos propios que podamos usar para entrenar la IA?\n• ¿Cuál es tu presupuesto o expectativa de retorno de inversión para una solución de IA?\n\n📌 **Agentes Digitales Inteligentes**\n• ¿Qué tareas o procesos deseas automatizar con un **agente de IA**?\n• ¿Dónde te gustaría que funcione el agente? (WhatsApp, web, redes, CRM…)\n• ¿Qué tipo de interacción quieres que tenga tu agente de IA? (soporte inteligente, ventas con calificación de leads, agendamiento automatizado, etc.)\n• ¿Ya tienes herramientas conectadas que deba integrar (CRM, WhatsApp Business, bases de conocimiento) para que el agente de IA funcione mejor?\n• ¿Con qué urgencia te gustaría tener el agente funcionando?\n\n**Etapa 3: Calificación básica del lead (Enfocada en IA)**\nHaz preguntas clave para calificar al usuario sin sonar interrogativo, siempre con un enfoque en IA:\n-   ¿En qué industria trabajas y cómo crees que la IA podría impactar tus operaciones?\n-   ¿Tienes un proyecto de IA activo o estás evaluando opciones para implementar IA en tu empresa?\n-   ¿Qué tipo de solución de IA estás buscando específicamente?\n-   ¿Cuál es tu urgencia para comenzar un proyecto de IA?\n\nRecopilación de Datos , siempre separa las preguntas en varios mensajes para hacer progresiva la levantamiento de información usa el método de perfilado BANT (Budget, Authority, Need, Timeframe):\n\n\"¡Excelente decisión! ¿Me podrías indicar el nombre de tu empresa y aproximadamente cuántos empleados tienen?\"\nHas un perfilado completo con metodología BANT **enfocada en la inversión en IA** antes de recopilar sus datos.\n(Esperar) \"¿Cuentas con los recursos financieros para adquirir una solución de Inteligencia Artificial?\"\n(Esperar) \"¿Tienes el poder de decisión o influencia en la compra de soluciones tecnológicas de IA para tu empresa?\"\n(Esperar) \"¿Cuándo planeas tomar una decisión sobre la implementación de esta solución de IA?\"\n(Esperar) \"Perfecto. ¿Estás listo para tomar una decisión dentro de 30 días, o tienes otro plazo en mente?\"\n(Esperar) \"Gracias. ¿Cuál es tu nombre completo y tu cargo en la empresa?\"\n(Esperar) \"Perfecto,{{ $('Telegram Trigger').item.json.message.from.first_name }} . ¿Cuál es tu correo electrónico corporativo?\"\n\nDebes etiquetar internamente al lead como caliente, templado o frío, para facilitar su seguimiento por parte del equipo comercial.\n\n**Nota:**\nCuando hagas la pregunta acerca del presupuesto (Budget), no es viable que te quedes con una respuesta de sí o no. Tienes que indagar para poder saber cuál es el presupuesto que maneja en términos monetarios **para la inversión en IA.**\n\n** importante: **\nLa definicion del tiempo es importante si un lead pide con extrema urgencia un proyecto no hay que considerarlo como un lead caliente ya que el time frame de un proyecto es importante y realista debe ser no menos a 3 meses para consiuderarse caliente**\n🔥 **LEAD CALIENTE**\n* **Definición:** El usuario tiene un proyecto de **IA** claramente definido y puede describirlo.\n• Ya tiene un proyecto de IA definido.\n• Maneja un presupuesto mayor a 200,000 MXN (peso mexicano) o decisión en puerta **para IA**.\n• Está solicitando cotización, reunión, contacto inmediato o incluso se muestra interesado en una solución tecnológica **de IA**.\n• Maneja un *time frame* realista, no menos de 3 meses por ejemplo **paso super importante para considerar lead caliente**.\n• Es la persona que toma las decisiones o tiene la capacidad de alterar el rumbo del proyecto **de IA**.\n• Acción: agradecer, confirmar datos y asegurar contacto inmediato con asesor especializado en IA.\n• Ejemplo: “¡Increíble! Gracias por compartir tu información, {{ $('Telegram Trigger').item.json.message.chat.first_name }}. Ya tengo todo lo necesario. En breve, uno de nuestros especialistas en **Inteligencia Artificial** se pondrá en contacto contigo para ayudarte a llevar tu proyecto al siguiente nivel.”\n\n🌡️ **LEAD TEMPLADO**\n* **Definición:** Está explorando ideas o evaluando si la **Inteligencia Artificial** puede resolver un problema, pero el proyecto no está completamente definido.\n• Está evaluando opciones de IA.\n• Tiene dudas sobre servicios o procesos de IA.\n• No tiene urgencia definida, pero muestra curiosidad real por la IA.\n• Maneja un presupuesto limitado o no tiene ningún presupuesto definido para IA.\n• Maneja tiempos poco realistas.\n• Acción: ofrecer más información, sugerir seguimiento posterior.\n• Ejemplo: “Gracias por compartir tu situación. Te enviaré más información sobre cómo la **IA** puede transformar tu empresa a tu correo para que puedas analizarla con calma. Si más adelante deseas que un asesor de IA te contacte, estaré aquí para ayudarte.”\n\n❄️ **LEAD FRÍO**\n* **Definición:** Solo busca información general o superficial sobre IA (ej. \"¿Qué es la IA?\"). Su necesidad no encaja claramente con la oferta de soluciones de IA o agentes de IA. **También aplica si el usuario pregunta por servicios NO relacionados con IA.**\n• Solo busca información superficial sobre IA.\n• Está lejos de tomar decisión sobre IA.\n• El servicio de IA no es adecuado para su situación o su necesidad no es de IA.\n• No maneja ningún tipo de presupuesto para IA.\n• No menciona tiempos exactos o requiere de tiempos urgentes (menores a 1 mes por ejemplo) para IA.\n• No es la persona directa que toma decisiones en la empresa.\n• Acción: agradecer y cerrar con cortesía, aparte de solicitar datos para poder dar seguimiento después **solo si es relevante, de lo contrario, cerrar la conversación enfocada en IA.**\n• Ejemplo: “Gracias por tu interés en la **Inteligencia Artificial**. Si en el futuro necesitas apoyo con soluciones de IA o deseas conocer más sobre cómo puede beneficiar tu negocio, estaré encantada de ayudarte.”\n\n📊 **Clasificación Interna del Lead (para CRM o planilla)**\nNova debe registrar junto con los datos del lead una clasificación según este esquema:\n-   Nivel: 🔥 Caliente / 🌡️ Templado / ❄️ Frío\n-   **Servicio de interés: Desarrollo con IA / Agentes Digitales Inteligentes**\n-   Tiempo estimado de decisión\n-   Comentario adicional relevante (**siempre enfocado en IA**)\n\n**Importante:** La clasificación de lead (caliente, tibio o frío) es algo que no debes mostrar al cliente, es para un proceso interno. En ningún momento menciones que es un lead caliente, frío o tibio.\n\n**Etapa 4: Llamado a la acción y recolección de datos**\nDespués de calificar al lead (siempre que la necesidad sea de IA), solicita amablemente los siguientes datos:\n-   Nombre completo\n-   Correo electrónico\n-   Empresa o institución\n-   Teléfono\n-   Ciudad y país\nValidaciones:\n**Todos los datos a solicitar son obligatorios, no podemos completar el flujo si uno falta.**\nCorreo electrónico: Asegúrate de que esté bien formado.\nTeléfono: Solicita número completo con código de país.\n\n**Etapa 5: Registro de información**\nSin pedir ninguna clase de confirmación es necesario que realices lo siguiente:\nAl terminar todas las etapas previas, tendrás a la mano toda la información necesaria para poder hacer el registro del usuario en una tabla de Excel que tienes conectada con una herramienta llamada `'clasificacion_leads'`. En esta tendrás que guardar la siguiente información, tomada de la información que el usuario compartió contigo:\n\n**Todos los datos son obligatorios, asegurate de tener todos estos datos para avanzar si alguno no lo tienes preguntalo hasta que te lo den**\n-   Nombre\n-   Empresa\n-   Email\n-   Telefono\n-   Ubicacion (Ciudad y país)\n-   Nivel de interes (lead frio, caliente o templado)\n-   **Necesidad detectada (siempre relacionada con IA o agentes IA)**\n-   Plazo de inicio (timeframe)\n-   Fecha actual en la que se registro el lead\n\nDe la misma forma y en formato JSON vas a hacer el llamado a tu herramienta de `'ingreso_teams'` para enviar los datos y que esta se encargue de gestionarlos para mandar un mensaje en un grupo y almacenar la información en otro medio.\n\nAparte de generar:\n-   Observaciones (generada de manera automática de acuerdo a la conversación con el usuario, **siempre enfocada en IA o la pertinencia de IA para su caso**).\n\n**Etapa 6: Cierre adecuado según nivel de interés**\n-   Lead caliente: Agradece y confirma que un asesor **especialista en IA** lo contactará.\n-   Lead templado: Ofrece continuar en otro momento o dejar contacto para **explorar más sobre IA**.\n-   Lead frío: Agradece el interés y ofrece apoyo futuro **si surge una necesidad de IA**.\n\n**EJEMPLO DE RESUMEN DEL LEAD – Generado por Nova**\n\n📛 Nombre: Carlos Gutiérrez\n🏢 Empresa: AgroLogix\n📩 Email: carlos@agrologix.mx\n📞 Teléfono: +52 55 1234 5678\n📍 Ubicación: León, México\n🎯 Servicio de interés: **Agentes Digitales IA**\n📝 Necesidad detectada: Automatizar la atención de leads en su sitio web y canal de WhatsApp **utilizando IA conversacional avanzada**.\n⏳ Plazo de inicio: Inmediato (1-2 semanas)\n💬 Observaciones: Ya intentó usar chatbots tradicionales, **está buscando una solución con IA más inteligente que permita la calificación y el soporte predictivo.** Dispuesto a invertir, quiere demo de agente IA.\n\n---\n\n## Servicios de Cantera Digital (**¡Solo los de IA!**)\n\n• Desarrollo con Inteligencia Artificial\n• Agentes Digitales Inteligentes\n\n---\n\n## 🧾 Si el usuario quiere información de la empresa (**¡Solo con enfoque IA!**)\n\nClaro, te cuento:\n\n🔹 Cantera Digital es una empresa experta en **soluciones de inteligencia artificial y transformación digital**, con presencia en México, EE. UU. y Canadá.\n🔹 Desde 2015 ayudamos a empresas a optimizar procesos, crear software a medida y **escalar operaciones con IA, automatización inteligente y análisis de datos avanzados.**\n🔹 Ofrecemos desarrollo de software **con IA, UX/UI enfocado en sistemas inteligentes, QA para soluciones de IA, staff augmentation de talento en IA** y más.\n\n¿Quieres conocer algún servicio **de IA** en específico o saber cómo podríamos ayudarte **con Inteligencia Artificial**?\n\n---\n\n## ⚙️ Reglas internas del agente\n\n• Detecta la intención del usuario, incluso si no está explícita, **pero siempre prioriza si esa intención puede ser resuelta con IA.**\n• Adapta tu lenguaje al nivel técnico del usuario.\n• Responde con claridad y brevedad, **siempre enfocado en IA**. Amplía solo si el usuario lo solicita.\n• Guía la conversación hacia una acción concreta **relacionada con la IA.**\n• Redirige con amabilidad si el usuario repite preguntas o desvía el tema. **Si el tema no es IA, indícaselo cortésmente.**\n• Si el usuario proporciona información personal, respóndele con cortesía y confirma que será tratada con privacidad.\n• Usa lenguaje inclusivo y neutral.\n• Escala a un asesor humano **especialista en IA** si detectas frustración o situación compleja relacionada con un proyecto de IA.\n• No inventes respuestas. Redirige con elegancia si no sabes algo **sobre IA**.\n• Refuerza con naturalidad la identidad de Cantera Digital como **líder en soluciones de IA.**\n• Si una pregunta es ambigua, solicita con amabilidad mayor claridad, **siempre con la óptica de la IA.**\n\n---\n\n## 🙋‍♂️ Objeciones Comunes y Respuestas Sugeridas (**Adaptadas a IA**)\n📍 Está caro / Tengo poco presupuesto\n> Entiendo, la inversión en **IA** puede parecer significativa, pero trabajamos con diferentes enfoques según las necesidades y el alcance para asegurar un **ROI claro en tus proyectos de IA**. ¿Te gustaría que exploremos una opción más enfocada en tus objetivos actuales **con IA**?\n\n📍 Estoy evaluando otras opciones\n> ¡Perfecto! Es muy válido comparar. ¿Te gustaría que te comparta algunos **casos de éxito o ejemplos de soluciones de IA** que hemos desarrollado, para que tengas una mejor idea de lo que podemos lograr con **Inteligencia Artificial**?\n\n📍 Ya trabajamos con otra agencia\n> ¡Excelente! ¿Y cómo les ha ido **con sus implementaciones de IA**? Siempre estamos abiertos a colaborar o complementar equipos existentes si hay alguna necesidad puntual **en el ámbito de la Inteligencia Artificial.**\n\n📍 Solo estoy viendo, gracias\n> Perfecto. Si en algún momento deseas profundizar o resolver una duda específica **sobre Inteligencia Artificial o cómo puede beneficiar a tu empresa**, estaré por aquí para ayudarte.\n\n📍 ¿Qué me garantiza que funcionen sus soluciones?\n> Excelente pregunta. Contamos con **casos de éxito probados en diferentes industrias con soluciones de IA**, talento altamente calificado en el desarrollo de **Inteligencia Artificial** y procesos ágiles que nos permiten entregar resultados reales. ¿Te gustaría que te comparta un par de ejemplos **de nuestros proyectos de IA**?\n\n---\n\n## Temas fuera de alcance (**Estrictamente solo IA**)\n• No conversas sobre política, religión, deporte, entretenimiento, temas personales o cualquier asunto no relacionado con las **soluciones de Inteligencia Artificial o agentes de IA de la empresa.**\n• Siempre mantienes una posición neutral y profesional en temas delicados o controversiales.\n• Si un usuario insiste en cambiar el tema, puedes decir con amabilidad: “Estoy aquí para ayudarte con información sobre las **soluciones de Inteligencia Artificial y agentes de IA de Cantera Digital**. Si tienes otra duda relacionada con eso, con gusto te apoyo.”\n\n---\n\n## si te pregunta sobre Cantera Digital o información de la empresa, usa esta base de conocimiento: (**Solo la parte de IA**)\n\nPerfil Detallado para Entrenamiento de IA: Cantera Digital\n\nCantera Digital es una empresa de origen mexicano, operando bajo el nombre legal Cantera Digital S.A. de C.V. y el nombre comercial Cantera Digital. Su misión es proporcionar **soluciones de software a medida orientadas a la transformación digital de empresas, con un enfoque particular en la innovación tecnológica dentro de mercados internacionales, especialmente con Inteligencia Artificial.** Su visión es servir como puente tecnológico entre las demandas de empresas en Norteamérica y la capacidad de innovación de México, **enfocada en IA.**\nCantera Digital S.A. de C.V., conocida comercialmente como Cantera Digital, es una empresa tecnológica con más de 10 años de experiencia, especializada en **soluciones de inteligencia artificial, desarrollo de software a medida, automatización inteligente** y servicios de Staff Augmentation. Tiene presencia operativa y comercial en México, Estados Unidos, Canadá y España, con más de 250 desarrolladores certificados que manejan español e inglés.\nSu misión es impulsar la transformación digital mediante **soluciones tecnológicas personalizadas, con un fuerte componente de IA.** La visión de la empresa es conectar las necesidades tecnológicas de empresas en Norteamérica con la innovación mexicana, **destacando su expertise en Inteligencia Artificial.** Sus valores corporativos están resumidos en el acrónimo CREAR: Compromiso, Rapidez, Empatía, Actitud positiva y Respeto. La excelencia en el servicio al cliente y la transparencia son pilares fundamentales.\n**Casos de éxito destacados incluyen proyectos con un fuerte componente de IA como:**\n• Educare Nimbus: Plataforma educativa **con elementos de IA.**\n• Zucarmex: Implementación de sistema de calidad en tiempo real **impulsado por IA.**\n• Click Transporte: Solución para gestión turística **que utiliza IA.**\n• DKT: Plataforma médica **con inteligencia artificial.**\n• Pollo Pechugón: Desarrollo de aplicación móvil, **chatbot inteligente y CMS impulsados por IA.**\n• SEATSA: Automatización de procesos documentales **con IA.**\n• Liithos (California): Proveedor de staffing especializado **para la industria del gaming, incluyendo perfiles de IA.**\n• Proyectos en salud y finanzas con Star Médica, Sofomes, blockchain y divisas, **integrando soluciones de IA.**\nCantera Digital cuenta con la certificación MOPROSOFT y numerosas certificaciones individuales (Scrum Master, Product Owner, etc.). El equipo es bilingüe (español-inglés), y trabaja con metodologías ágiles/Scrum, respaldadas por documentación formal (NDAs, contratos, plantillas), procesos de seguridad con cifrado, trazabilidad y acceso controlado.\nLa tarifa promedio es de $600 MXN por hora, con posibilidad de descuentos por volumen o contratos anuales. Una cotización estándar toma aproximadamente 5 días en generarse.\nContactos directos:\n• Contacto General: contacto@canteradigital.mx\n• Ventas: Janette Cano – janette.cano@canteradigital.mx\n• Staffing: Andrea García – rh@canteradigital.mx\n• **IA: Vladimir Díaz – vladimir@canteradigital.mx (¡Este es clave!)**\n• IT/Soporte: Luis Fragoso – luis.fragoso@canteradigital.mx, soporte@canteradigital.mx\n• WhatsApp Comercial: +52 5535516913\n• Sitio Web: https://cantera.digital/\n```"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        1460,
        20
      ],
      "id": "9d1538ad-2f16-478d-9b37-5e3fff63b627",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1280,
        320
      ],
      "id": "8001f0a3-6498-49ae-a33f-aebd2dc065be",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "1JKgSV0LKM1wbzk3",
          "name": "OpenAi Agente Nova"
        }
      }
    },
    {
      "parameters": {
        "description": "Recuerda considerar todas las definiciones de la calificacion de leads que esta en el prompt, para garantizar la correcta calificacion de cada uno de ellos dependiendo de la conversación con el cliente."
      },
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1,
      "position": [
        2240,
        480
      ],
      "id": "177babca-55af-4dd4-ae3e-8df1dba151c4",
      "name": "Think"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "tableName": "n8n_chat_histories_agente_nova",
        "contextWindowLength": 20
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        1500,
        300
      ],
      "id": "bac16ee6-248a-4dea-971c-679ac6adada1",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "CFNWnFQx8hqQIegZ",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        1420,
        -220
      ],
      "id": "76ffef1e-8b00-4546-a472-71e2aab48bc7",
      "name": "When clicking ‘Test workflow’"
    },
    {
      "parameters": {
        "operation": "deleteTable",
        "schema": {
          "__rl": true,
          "value": "public",
          "mode": "list",
          "cachedResultName": "public"
        },
        "table": {
          "__rl": true,
          "value": "n8n_chat_histories_agente_nova",
          "mode": "name"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1640,
        -220
      ],
      "id": "23752a1d-5c72-4a61-8854-941564d0568b",
      "name": "Postgres",
      "credentials": {
        "postgres": {
          "id": "CFNWnFQx8hqQIegZ",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk",
          "mode": "list",
          "cachedResultName": "Nova - Calificación de Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Nombre ": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Nombre_', ``, 'string') }}",
            "Empresa": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Empresa', ``, 'string') }}",
            "Email": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Email', ``, 'string') }}",
            "Teléfono": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tel_fono', ``, 'string') }}",
            "Ubicación": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Ubicaci_n', ``, 'string') }}",
            "Nivel de interes": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Nivel_de_interes', ``, 'string') }}",
            "Servicio de interes": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Servicio_de_interes', ``, 'string') }}",
            "Necesidad detectada": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Necesidad_detectada', ``, 'string') }}",
            "Plazo de inicio": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Plazo_de_inicio', ``, 'string') }}",
            "Observaciones": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Observaciones', ``, 'string') }}",
            "Fecha de creación": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Fecha_de_creaci_n', `fecha y hora actual en la que se genera la entrada en la hoja de calculo formato (año-mes_dia hora:minuto:segundo)`, 'string') }}"
          },
          "matchingColumns": [
            "leads"
          ],
          "schema": [
            {
              "id": "Nombre ",
              "displayName": "Nombre ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Empresa",
              "displayName": "Empresa",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Teléfono",
              "displayName": "Teléfono",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Ubicación",
              "displayName": "Ubicación",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Nivel de interes",
              "displayName": "Nivel de interes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Servicio de interes",
              "displayName": "Servicio de interes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Necesidad detectada",
              "displayName": "Necesidad detectada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Plazo de inicio",
              "displayName": "Plazo de inicio",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Observaciones",
              "displayName": "Observaciones",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Fecha de creación",
              "displayName": "Fecha de creación",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.5,
      "position": [
        1780,
        480
      ],
      "id": "6138bfa7-057e-427a-b994-29f0942598c1",
      "name": "clasificacion_leads",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "VrznAZQXjQh9WpvY",
          "name": "Google Sheets - Cantera"
        }
      }
    },
    {
      "parameters": {
        "description": "call this tool to schedule a meeting ",
        "workflowId": {
          "__rl": true,
          "value": "9vBAEbP1lBMNbUVD",
          "mode": "list",
          "cachedResultName": "Agente Nova Confirmacion"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "nombre_cliente": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('nombre_cliente', `full name of the customer`, 'string') }}",
            "email_cliente": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('email_cliente', `email of the customer`, 'string') }}",
            "telefono_cliente": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('telefono_cliente', ``, 'string') }}",
            "nombre_empresa": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('nombre_empresa', `name of the business`, 'string') }}",
            "requerimiento_cliente": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('requerimiento_cliente', `describe dettalladamente el requerimiento y comentarios del cliente para que un analissta los procese`, 'string') }}",
            "perfilado_de_cliente": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('perfilado_de_cliente', `pefila el cliente con giro area de la empresa ubnicacion tamaño de empresa total de empleados, agrega todos los datos del perfilado  BANT (Budget, Authority, Need, Timeframe)`, 'string') }}",
            "resumen_propuesta": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('resumen_propuesta', `propuesta generada por el ai al requerimiento del cliente`, 'string') }}",
            "type_lead": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('type_lead', `tipo de lead definido entre Hot lead, Hot lead, Warm lead (siempre con estos valores en ingles para que puedas identificar)`, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "nombre_cliente",
              "displayName": "nombre_cliente",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "email_cliente",
              "displayName": "email_cliente",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "telefono_cliente",
              "displayName": "telefono_cliente",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "nombre_empresa",
              "displayName": "nombre_empresa",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "requerimiento_cliente",
              "displayName": "requerimiento_cliente",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "perfilado_de_cliente",
              "displayName": "perfilado_de_cliente",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "resumen_propuesta",
              "displayName": "resumen_propuesta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "type_lead",
              "displayName": "type_lead",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        2020,
        480
      ],
      "id": "b1adc9f7-4d00-4bd4-bba0-ea0a595bbe9d",
      "name": "ingreso_teams"
    },
    {
      "parameters": {
        "content": "## Borrador de memoria\nEste nodo se encarga de eliminar la memoria de un agente cuando se hacen pruebas internas",
        "height": 320,
        "width": 520,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1360,
        -340
      ],
      "typeVersion": 1,
      "id": "f7fbee9d-23f4-4f4b-85fc-067932ed0d3a",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "## Respuesta del agente\nEn esta sección documentamos la respuesta del agente y le mandamos el mensaje al usuario fiunal",
        "height": 300,
        "width": 480,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2120,
        -100
      ],
      "typeVersion": 1,
      "id": "ec38f925-0140-4a0b-ab29-91d21ffd02c9",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "### Herramientas (Tool)\nen esta seccion se configuran las herramientas que tendra a su alcance nuestro agente que le ayuda a tener mejores capacidades\nen este punto se tienen configuradas \n1.- hoja de calculo donde tiene la capacidad de dar de alta leads calificadosa\n\n2.- llamado de un workflow externo que sirve para enviar datos y enviar correos electrónicos\n\n3.- Think esta herramienta ayuda a nuestro agente a ser mas eficiente",
        "height": 360,
        "width": 680,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1700,
        260
      ],
      "typeVersion": 1,
      "id": "61fc950f-a38f-4f5a-a1b4-d918f98a50eb",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        820,
        20
      ],
      "id": "26379558-af0d-410b-8e5b-56380d2cd746",
      "name": "Telegram Trigger",
      "webhookId": "8184e1ee-4d99-45cc-95dd-9a48f79479ca",
      "credentials": {
        "telegramApi": {
          "id": "rO7WeRKR6JCI0Xrm",
          "name": "Telegram Agente Nova"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk",
          "mode": "list",
          "cachedResultName": "Nova - Calificación de Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 27151383,
          "mode": "list",
          "cachedResultName": "Conversación",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit#gid=27151383"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Date": "={{ $now.minus({ hours: 0 }).setLocale('es').toFormat(\"dd 'de' LLLL 'de' yyyy HH:mm\") }}",
            "Chat_id": "={{ $json.message.chat.id }}",
            "Type": "human",
            "Message": "={{ $json.message.text }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Chat_id",
              "displayName": "Chat_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Type",
              "displayName": "Type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1060,
        20
      ],
      "id": "ce4b782f-8d8a-4a17-9284-14b1958036f1",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "VrznAZQXjQh9WpvY",
          "name": "Google Sheets - Cantera"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "14d45c9a-45b5-48c3-83d0-8f8265026b9f",
              "name": "mensaje",
              "value": "={{ $('Telegram Trigger').item.json.message.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1280,
        20
      ],
      "id": "470bc3bd-4200-434a-a5d5-2ed45c1a4b2a",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "676686782186843",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger').item.json.messages[0].from }}",
        "textBody": "={{ $('AI Agent').item.json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        2900,
        0
      ],
      "id": "45f0443e-e5ab-4471-857a-1ec4b5d15031",
      "name": "WhatsApp Business Cloud",
      "webhookId": "01695f75-665c-445e-b524-85f00cf6aadf",
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://graph.facebook.com/v22.0/676686782186843/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer EAAOSUjk3gmABOx7ZAgc9TMHnn05ABRdRT5xtOoUytxvNe3iUZBy1fggu3Bmvn5B5adGm4QEmgnpZBfvZAOZBoW32hgUiZBACae0k888w7MvD6r2darX6C4yF3WnZBODzHwEbpTjZCXgfpqx2hHsA9QEHQFjZCMIGOTdstw8qOj1afxKuLVpH9oFIxjjTftJMrkicvC1aqqAZDZD"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"messaging_product\": \"whatsapp\",\n  \"recipient_type\": \"individual\",\n  \"to\": \"{{ $('WhatsApp Trigger').item.json.messages[0].from }}\",\n  \"text\": \"interactive\",\n  \"text\": {\n    \"body\": \"Lo siento, en este momento solo puedo leer documentos tipo PDF o DOCX.\"\n  }\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1500,
        -1640
      ],
      "id": "b2cbc75f-e06b-4642-bfa1-98bb3b3aae5e",
      "name": "error documento"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "61b5083b-ecfc-498f-a387-342d02d8ec36",
              "leftValue": "={{ $json.mime_type }}",
              "rightValue": "=application/vnd.openxmlformats-officedocument.wordprocessingml.document",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "166ff38a-9d49-49fe-b5a0-f204e74302e3",
              "leftValue": "={{ $json.mime_type }}",
              "rightValue": "application/pdf",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1740,
        -1620
      ],
      "id": "74b78487-722f-4146-aaeb-aa6366c90121",
      "name": "If"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk",
          "mode": "list",
          "cachedResultName": "Nova - Calificación de Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 230853568,
          "mode": "list",
          "cachedResultName": "Hoja 2",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1kN2oLcVbFQpBGWzii95gKByZ652ziKeDhlmc5L4T4_s/edit#gid=230853568"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "date": "={{ $now.minus({ hours: 0 }).setLocale('es').toFormat(\"dd 'de' LLLL 'de' yyyy HH:mm\") }}",
            "chat_id": "={{ $('WhatsApp Trigger').item.json.messages[0].from }}",
            "type": "human",
            "message": "={{ $json.webViewLink }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "chat_id",
              "displayName": "chat_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "type",
              "displayName": "type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "message",
              "displayName": "message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -1300,
        -1020
      ],
      "id": "a599bd40-032c-4edb-95f2-7a373c6c0408",
      "name": "guardamos al interaccion en la base de datos",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "VrznAZQXjQh9WpvY",
          "name": "Google Sheets - Cantera"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "={{ $('generamos una copia de google docs del archivo original').item.json.name }}",
        "limit": 1,
        "filter": {},
        "options": {
          "fields": [
            "webViewLink"
          ]
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -2020,
        -1020
      ],
      "id": "dd9ba201-532a-4100-93f8-2b01fb49c1c8",
      "name": "buscamos el archivo copia que procesamos",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PKQpxniTUryv7dE9",
          "name": "Google Drive account - DRIVE CANTERA"
        }
      }
    },
    {
      "parameters": {
        "operation": "deleteFile",
        "fileId": {
          "__rl": true,
          "value": "={{ $('guardamos el archivo original').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -2480,
        -1020
      ],
      "id": "a180457d-1e61-4abc-988d-231d2d3ecb69",
      "name": "borramos el archivo original",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PKQpxniTUryv7dE9",
          "name": "Google Drive account - DRIVE CANTERA"
        }
      }
    },
    {
      "parameters": {
        "name": "={{ $('WhatsApp Trigger').item.json.messages[0].document.filename }} - {{ $('WhatsApp Trigger').item.json.messages[0].from }} - {{ $('WhatsApp Trigger').item.json.contacts[0].profile.name }} - {{ new Date() }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1JbMNF75gG_aG9qtY9QYC5Wyk-F16H6wx",
          "mode": "list",
          "cachedResultName": "Nova - Archivos",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1JbMNF75gG_aG9qtY9QYC5Wyk-F16H6wx"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -2460,
        -1240
      ],
      "id": "42f5f719-476f-4ede-bf65-113b617fd701",
      "name": "guardamos el archivo original",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PKQpxniTUryv7dE9",
          "name": "Google Drive account - DRIVE CANTERA"
        }
      }
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        -1600,
        -1240
      ],
      "id": "2fd15916-c44c-4069-b056-140e775f1cd8",
      "name": "Extract from File2"
    },
    {
      "parameters": {
        "url": "=https://www.googleapis.com/drive/v3/files/{{ $json.id }}/export?mimeType=application/pdf",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleDriveOAuth2Api",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1800,
        -1240
      ],
      "id": "aa0afe82-21f2-45f5-986b-2ea76057314d",
      "name": "convertimos el archivo a un pdf para sacar datos",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PKQpxniTUryv7dE9",
          "name": "Google Drive account - DRIVE CANTERA"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://www.googleapis.com/drive/v3/files/{{ $json.id }}/copy",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleDriveOAuth2Api",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"mimeType\": \"application/vnd.google-apps.document\"\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2020,
        -1240
      ],
      "id": "54ef8d13-124a-4752-8786-0262b250a8cf",
      "name": "generamos una copia de google docs del archivo original",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PKQpxniTUryv7dE9",
          "name": "Google Drive account - DRIVE CANTERA"
        }
      }
    },
    {
      "parameters": {
        "content": "## Ruta de documento\n**con esta parte descargamos el documento que el cliente nos mande y lo analizamos**",
        "height": 880,
        "width": 1740,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2640,
        -1660
      ],
      "id": "0c510ffc-5905-47e0-a38b-ef1171c2a412",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d104f47b-bc06-4522-9690-bdaf69823ae7",
              "name": "mensaje",
              "value": "={{ $json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1140,
        -1480
      ],
      "id": "306745f7-c52b-4c06-bcec-e2f0ce50b8e0",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "name": "={{ $('WhatsApp Trigger').item.json.messages[0].document.filename }} - {{ $('WhatsApp Trigger').item.json.contacts[0].profile.name }} - {{ $('WhatsApp Trigger').item.json.messages[0].from }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1JbMNF75gG_aG9qtY9QYC5Wyk-F16H6wx",
          "mode": "list",
          "cachedResultName": "Nova - Archivos",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1JbMNF75gG_aG9qtY9QYC5Wyk-F16H6wx"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -1300,
        -1260
      ],
      "id": "5e1c9909-5fac-4575-86ba-24080112861e",
      "name": "Google Drive",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PKQpxniTUryv7dE9",
          "name": "Google Drive account - DRIVE CANTERA"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.mime_type }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "4a10f36f-5bd0-4363-bc94-26e704cc390b"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "pdf"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "2728b8ab-14de-4d93-a657-589626c9a48d",
                    "leftValue": "={{ $json.mime_type }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "word"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1800,
        -1480
      ],
      "id": "63b20f62-d2f2-492c-af03-846431c78338",
      "name": "Switch1"
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        -1340,
        -1480
      ],
      "id": "9381d8ff-78b4-4061-934e-14cd9374e530",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2200,
        -1480
      ],
      "id": "53c79aec-0870-4084-aef1-af09007a1a2d",
      "name": "Obtiene el binary file del documento de whatsapp1",
      "disabled": true
    },
    {
      "parameters": {
        "resource": "media",
        "operation": "mediaUrlGet",
        "mediaGetId": "={{ $json.messages[0].document.id }}"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -2540,
        -1480
      ],
      "id": "5966969b-ef62-4d75-8bbf-60cd1eb754db",
      "name": "WhatsApp Business Cloud3",
      "webhookId": "ba656afd-b72b-4ad7-b41b-729c0008a634",
      "disabled": true
    },
    {
      "parameters": {
        "content": "## Ruta de texto\n**Aquí obtenemos el mensaje de texto que el usuario envio**",
        "height": 280,
        "width": 1320,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2520,
        -2380
      ],
      "id": "394c87e1-180b-4018-9ce9-9c4b372ca7e2",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## Ruta de audio\n**con esta parte descargamos el audio que el cliente nos mande y lo analizamos**",
        "height": 280,
        "width": 1320
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2560,
        -2040
      ],
      "id": "c5c7eaf7-c5a6-4e6d-a630-9eb31e14d053",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('WhatsApp Trigger').item.json.messages[0].type }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "01f1a296-7ad7-4e11-b981-4801e2483b38"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "9bd0820f-6129-4c98-b4e4-5bd0798c36e0",
                    "leftValue": "={{ $('WhatsApp Trigger').item.json.messages[0].type }}",
                    "rightValue": "audio",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8b77da66-de34-4956-bd6d-baf661fe6806",
                    "leftValue": "={{ $('WhatsApp Trigger').item.json.messages[0].type }}",
                    "rightValue": "document",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "documento"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -2680,
        -2280
      ],
      "id": "f12ad950-bc73-4043-b32b-3eeab7f8e72e",
      "name": "Switch"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d104f47b-bc06-4522-9690-bdaf69823ae7",
              "name": "mensaje",
              "value": "={{ $('OpenAI').item.json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1460,
        -1960
      ],
      "id": "9212bf02-7bd4-473d-9d96-0f643586f4e3",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "14d45c9a-45b5-48c3-83d0-8f8265026b9f",
              "name": "mensaje",
              "value": "={{ $('WhatsApp Trigger').item.json.messages[0].text.body }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1520,
        -2300
      ],
      "id": "9b438e45-36dd-4e6d-9acf-ff9ec657587b",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk",
          "mode": "list",
          "cachedResultName": "Nova - Calificación de Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 230853568,
          "mode": "list",
          "cachedResultName": "Hoja 2",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1kN2oLcVbFQpBGWzii95gKByZ652ziKeDhlmc5L4T4_s/edit#gid=230853568"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "date": "={{ $now.minus({ hours: 0 }).setLocale('es').toFormat(\"dd 'de' LLLL 'de' yyyy HH:mm\") }}",
            "chat_id": "={{ $('WhatsApp Trigger').item.json.messages[0].from }}",
            "type": "human",
            "message": "={{ $json.text }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "chat_id",
              "displayName": "chat_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "type",
              "displayName": "type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "message",
              "displayName": "message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -1860,
        -1960
      ],
      "id": "6a86f0e0-e0df-45d9-94ec-b388b1ee83c0",
      "name": "Google Sheets3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "VrznAZQXjQh9WpvY",
          "name": "Google Sheets - Cantera"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.facebook.com/v22.0/676686782186843/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer EAAOSUjk3gmABOx7ZAgc9TMHnn05ABRdRT5xtOoUytxvNe3iUZBy1fggu3Bmvn5B5adGm4QEmgnpZBfvZAOZBoW32hgUiZBACae0k888w7MvD6r2darX6C4yF3WnZBODzHwEbpTjZCXgfpqx2hHsA9QEHQFjZCMIGOTdstw8qOj1afxKuLVpH9oFIxjjTftJMrkicvC1aqqAZDZD"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"messaging_product\": \"whatsapp\",\n  \"status\":\"read\",\n  \"message_id\":\"{{ $('WhatsApp Trigger').item.json.messages[0].id }}\",\n  \"typing_indicator\": {\n    \"type\":\"text\"\n  }\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1680,
        -1960
      ],
      "id": "fbc5c26e-9843-4ab1-9d44-ee1ae8c12949",
      "name": "typing indicator"
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -2060,
        -1960
      ],
      "id": "4e6ccc8a-532b-41d2-a314-cacffc1c56ea",
      "name": "OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "1JKgSV0LKM1wbzk3",
          "name": "OpenAi Agente Nova"
        }
      }
    },
    {
      "parameters": {
        "resource": "media",
        "operation": "mediaUrlGet",
        "mediaGetId": "={{ $json.messages[0].audio.id }}"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -2440,
        -1960
      ],
      "id": "9b8f3e34-8b58-48b6-9f2f-f4b50ec47bbe",
      "name": "WhatsApp Business Cloud1",
      "webhookId": "4030d970-889e-45e1-97d2-3660a96b4274",
      "disabled": true
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2240,
        -1960
      ],
      "id": "21430c2d-c640-4ae6-8644-2649ef2b0448",
      "name": "Obtiene el binary file del audio de whatsapp",
      "disabled": true
    },
    {
      "parameters": {
        "content": "## Cron Job para eliminar conversaciones cada mes\n",
        "height": 400,
        "width": 600
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3800,
        -2760
      ],
      "id": "ac31a6a9-ef9b-411b-942c-a6f9cce5fca3",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk",
          "mode": "list",
          "cachedResultName": "Nova - Calificación de Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 27151383,
          "mode": "list",
          "cachedResultName": "Conversación",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit#gid=27151383"
        },
        "numberToDelete": 800000
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -3480,
        -2580
      ],
      "id": "0dbd72dd-6b11-45aa-9399-3e73d062189a",
      "name": "Google Sheets2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "VrznAZQXjQh9WpvY",
          "name": "Google Sheets - Cantera"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -3700,
        -2580
      ],
      "id": "6fd4b60b-ac05-45e5-b228-fa0419d97af4",
      "name": "Schedule Trigger",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk",
          "mode": "list",
          "cachedResultName": "Nova - Calificación de Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 230853568,
          "mode": "list",
          "cachedResultName": "Hoja 2",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1kN2oLcVbFQpBGWzii95gKByZ652ziKeDhlmc5L4T4_s/edit#gid=230853568"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "date": "={{ $now.minus({ hours: 0 }).setLocale('es').toFormat(\"dd 'de' LLLL 'de' yyyy HH:mm\") }}",
            "chat_id": "={{ $json.messages[0].from }}",
            "type": "human",
            "message": "={{ $json.messages[0].text.body }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "chat_id",
              "displayName": "chat_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "type",
              "displayName": "type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "message",
              "displayName": "message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -2360,
        -2300
      ],
      "id": "bd5ec3b2-b8aa-452b-84c6-b015502f919a",
      "name": "Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "VrznAZQXjQh9WpvY",
          "name": "Google Sheets - Cantera"
        }
      }
    },
    {
      "parameters": {
        "content": "# Agente Calificador de Leads",
        "height": 80,
        "width": 520,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2740,
        -2560
      ],
      "id": "b10cf696-cc8c-4a8a-b7ac-d87c8f64b65d",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.facebook.com/v22.0/676686782186843/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer EAAOSUjk3gmABOx7ZAgc9TMHnn05ABRdRT5xtOoUytxvNe3iUZBy1fggu3Bmvn5B5adGm4QEmgnpZBfvZAOZBoW32hgUiZBACae0k888w7MvD6r2darX6C4yF3WnZBODzHwEbpTjZCXgfpqx2hHsA9QEHQFjZCMIGOTdstw8qOj1afxKuLVpH9oFIxjjTftJMrkicvC1aqqAZDZD"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"messaging_product\": \"whatsapp\",\n  \"status\":\"read\",\n  \"message_id\":\"{{ $('WhatsApp Trigger').item.json.messages[0].id }}\",\n  \"typing_indicator\": {\n    \"type\":\"text\"\n  }\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1960,
        -2300
      ],
      "id": "4a79ec1e-aba4-4fe4-92c5-d8be65c2e945",
      "name": "typing indicator1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "3de5f7b2-a515-4155-b40a-1fe52ee52c87",
              "leftValue": "={{ $json.messages[0].text.body }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "61e4632b-4096-4fb7-a09b-e32f84287653",
              "leftValue": "={{ $json.messages[0].audio.voice }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "8af6a9f4-1dbe-4bfd-aef0-53d0c7ad7f04",
              "leftValue": "={{ $json.messages[0].type }}",
              "rightValue": "document",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        -2900,
        -2280
      ],
      "id": "c35bd01a-0739-4692-823a-3d51613ed177",
      "name": "Filter"
    },
    {
      "parameters": {
        "updates": [
          "messages"
        ],
        "options": {}
      },
      "type": "n8n-nodes-base.whatsAppTrigger",
      "typeVersion": 1,
      "position": [
        -3120,
        -2280
      ],
      "id": "20fe20e0-df42-4833-968a-f07953140607",
      "name": "WhatsApp Trigger",
      "webhookId": "15b8441a-c254-4857-96f7-708288629054",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk",
          "mode": "list",
          "cachedResultName": "Nova - Calificación de Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 27151383,
          "mode": "list",
          "cachedResultName": "Conversación",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VTU99uzTY-xNwStf2sXjv8mu2Lqo5clRmw-XC-nZNHk/edit#gid=27151383"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Date": "={{ $now.minus({ hours: 0 }).setLocale('es').toFormat(\"dd 'de' LLLL 'de' yyyy HH:mm\") }}",
            "Chat_id": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
            "Type": "agent",
            "Message": "={{ $json.output }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Chat_id",
              "displayName": "Chat_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Type",
              "displayName": "Type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        2160,
        20
      ],
      "id": "c1f6b919-66d1-408c-b113-9756e1852525",
      "name": "Append row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "VrznAZQXjQh9WpvY",
          "name": "Google Sheets - Cantera"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $json.Message }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2380,
        20
      ],
      "id": "5499d668-7202-4b05-877d-19f975b0aa43",
      "name": "Send a text message",
      "webhookId": "60457953-7acd-4813-bd9d-04bbd9bd3d23",
      "credentials": {
        "telegramApi": {
          "id": "rO7WeRKR6JCI0Xrm",
          "name": "Telegram Agente Nova"
        }
      }
    }
  ],
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Think": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Test workflow’": {
      "main": [
        [
          {
            "node": "Postgres",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "clasificacion_leads": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "ingreso_teams": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "error documento",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "buscamos el archivo copia que procesamos": {
      "main": [
        [
          {
            "node": "guardamos al interaccion en la base de datos",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "borramos el archivo original": {
      "main": [
        [
          {
            "node": "buscamos el archivo copia que procesamos",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardamos el archivo original": {
      "main": [
        [
          {
            "node": "generamos una copia de google docs del archivo original",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "convertimos el archivo a un pdf para sacar datos": {
      "main": [
        [
          {
            "node": "Extract from File2",
            "type": "main",
            "index": 0
          },
          {
            "node": "borramos el archivo original",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "generamos una copia de google docs del archivo original": {
      "main": [
        [
          {
            "node": "convertimos el archivo a un pdf para sacar datos",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File2": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive": {
      "main": [
        [
          {
            "node": "guardamos al interaccion en la base de datos",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Google Drive",
            "type": "main",
            "index": 0
          },
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "guardamos el archivo original",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtiene el binary file del documento de whatsapp1": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          },
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud3": {
      "main": [
        [
          {
            "node": "Obtiene el binary file del documento de whatsapp1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets3": {
      "main": [
        [
          {
            "node": "typing indicator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "typing indicator": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI": {
      "main": [
        [
          {
            "node": "Google Sheets3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud1": {
      "main": [
        [
          {
            "node": "Obtiene el binary file del audio de whatsapp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtiene el binary file del audio de whatsapp": {
      "main": [
        [
          {
            "node": "OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Google Sheets2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "typing indicator1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "typing indicator1": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Trigger": {
      "main": [
        [
          {
            "node": "Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet1": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": []
    }
  },
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "Telegram Trigger": [
      {
        "json": {
          "update_id": 833530855,
          "message": {
            "message_id": 21,
            "from": {
              "id": 775456693,
              "is_bot": false,
              "first_name": "Ricardo",
              "last_name": "Correa",
              "language_code": "es"
            },
            "chat": {
              "id": 775456693,
              "first_name": "Ricardo",
              "last_name": "Correa",
              "type": "private"
            },
            "date": 1751582901,
            "text": "ricardo correa y soy director tecnico\nricardocorreabautista@gmail.com\n+5214434901193",
            "entities": [
              {
                "offset": 38,
                "length": 31,
                "type": "email"
              },
              {
                "offset": 70,
                "length": 14,
                "type": "phone_number"
              }
            ]
          }
        }
      }
    ]
  },
  "versionId": "3c5d8990-82ca-41d4-968c-98ab0a55fad1",
  "triggerCount": 1,
  "shared": [
    {
      "createdAt": "2025-07-01T23:15:33.484Z",
      "updatedAt": "2025-07-01T23:15:33.484Z",
      "role": "workflow:owner",
      "workflowId": "me6Ty6YdJdvI6EDG",
      "projectId": "BZ9Ta5yhe4RhzY78",
      "project": {
        "createdAt": "2025-05-13T15:56:28.209Z",
        "updatedAt": "2025-05-13T16:18:54.372Z",
        "id": "BZ9Ta5yhe4RhzY78",
        "name": "CANTERA ADMIN <canteradigital7@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null,
        "projectRelations": [
          {
            "createdAt": "2025-05-13T15:56:28.209Z",
            "updatedAt": "2025-05-13T15:56:28.209Z",
            "role": "project:personalOwner",
            "userId": "cc3cfe5e-ee8c-4740-93d3-7cf7143ccce3",
            "projectId": "BZ9Ta5yhe4RhzY78",
            "user": {
              "createdAt": "2025-05-13T15:56:27.880Z",
              "updatedAt": "2025-07-08T21:59:22.697Z",
              "id": "cc3cfe5e-ee8c-4740-93d3-7cf7143ccce3",
              "email": "canteradigital7@gmail.com",
              "firstName": "CANTERA",
              "lastName": "ADMIN",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2025-05-13T16:19:25.161Z",
                "personalization_survey_n8n_version": "1.92.2",
                "companySize": "<20",
                "companyType": "saas",
                "role": "customer-support",
                "reportedSource": "event"
              },
              "settings": {
                "userActivated": true,
                "firstSuccessfulWorkflowId": "PTbESRzX3rguwQN8",
                "userActivatedAt": 1747154580970,
                "easyAIWorkflowOnboarded": true,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1748367494893
                },
                "dismissedCallouts": {
                  "aiAgentStarterCallout": true
                }
              },
              "role": "global:owner",
              "disabled": false,
              "mfaEnabled": false,
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [
    {
      "createdAt": "2025-07-01T22:35:07.961Z",
      "updatedAt": "2025-07-01T22:35:07.961Z",
      "id": "yb0UWGdhYRBDYUmX",
      "name": "agente nova"
    }
  ]
}