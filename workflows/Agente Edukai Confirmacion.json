{
  "createdAt": "2025-07-02T00:07:35.911Z",
  "updatedAt": "2025-07-10T19:24:14.000Z",
  "id": "uXmZvPw4HonDoJtb",
  "name": "Agente Edukai Confirmacion",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "text": "={{ $json.message.content }}",
        "attributes": {
          "attributes": [
            {
              "name": "value",
              "type": "number",
              "description": "integer value of the usd value estimated of the project witout money symbol only number",
              "required": true
            },
            {
              "name": "propability",
              "type": "number",
              "description": "value  of probality of close this deal",
              "required": true
            },
            {
              "name": "detail_of_estimation",
              "description": "detailed explain of the estimation",
              "required": true
            },
            {
              "name": "type_lead",
              "description": "type lead based in the message HOT_LEAD, WARM_LEAD, COLD_LEAD "
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "You are an expert extraction algorithm.\nOnly extract relevant information from the text.\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value. redacta todo en espa√±ol"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1,
      "position": [
        320,
        -20
      ],
      "id": "99d54af9-0e65-4c44-bf54-58086e17a91f",
      "name": "Information Extractor"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-3.5-turbo",
          "mode": "list",
          "cachedResultName": "gpt-3.5-turbo"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        360,
        200
      ],
      "id": "29334306-da26-49fe-94f1-c67803f0c76f",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "nFhq9424Dw9eFpNq",
          "name": "OpenAi Agente Edukai"
        }
      }
    },
    {
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "nombre_cliente"
            },
            {
              "name": "email_cliente"
            },
            {
              "name": "telefono_cliente"
            },
            {
              "name": "nombre_empresa"
            },
            {
              "name": "requerimiento_cliente"
            },
            {
              "name": "perfilado_de_cliente"
            },
            {
              "name": "resumen_propuesta"
            },
            {
              "name": "type_lead"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -340,
        -20
      ],
      "id": "73833bff-e4bf-42d8-93d5-b0a0e7350de4",
      "name": "When Executed by Another Workflow"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "676686782186843",
        "recipientPhoneNumber": "={{ $('When Executed by Another Workflow').item.json.telefono_cliente }}",
        "textBody": "=Perfecto! ya tenemos todos tus datos, nuestros asesores se pondran en contacto contigo.{{\"\\n\"}} Estamos seguros que te sorprender√° nuestra propuesta.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        1280,
        -360
      ],
      "id": "1848d160-faf6-4044-b9b4-e477226e6d33",
      "name": "WhatsApp Business Cloud",
      "webhookId": "ebac2d4e-ceda-484c-a1b7-c7841588399d",
      "disabled": true
    },
    {
      "parameters": {
        "content": "## Interpretador\nEste nodo recibe una serie de parametros del lead como nombre, necesidad, empresa, presupuesto etc.\n\nse encarga de dar una interpretaci√≥n a esos datos y actua como un interprete y genera un texto con datos como probabilidad de cierre, valor del negocio, etc.",
        "height": 400,
        "width": 360,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -160,
        -240
      ],
      "typeVersion": 1,
      "id": "b2ff1314-e2a4-4ede-855a-49326b653a10",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Extractor\nObtiene el texto del primer nodo y toma la informaci√≥n que le pidamos y la retorna en variables utilizables",
        "height": 520,
        "width": 360,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        260,
        -240
      ],
      "typeVersion": 1,
      "id": "bf4ba111-93c1-4a3e-86d7-a3d3aae69d57",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Envio de informaci√≥n a areas comerciales\nEsta secci√≥n envia un mensaje por correo al area comercial aparte de generar un mensaje en un canal de teams para que sea visible cuando un lead llega.",
        "height": 340,
        "width": 600,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        780,
        -40
      ],
      "typeVersion": 1,
      "id": "7eec74a7-4d57-4a00-b05c-b8668aa5dae2",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Envio de correo a nuestro cliente\nEnviamos un correo electr√≥nico independientemente que ya exista o no en nuestro crm con los datos soobre su proyecto y la promesa de contacto futuro",
        "height": 640,
        "width": 340,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        740,
        -740
      ],
      "typeVersion": 1,
      "id": "349aca8e-a8e5-4b21-8816-d7c6c594e429",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "fromEmail": "info@edukai.consulting",
        "toEmail": "={{ $('When Executed by Another Workflow').item.json.email_cliente }}",
        "subject": "=En Edukai Tenemos una Porpuesta Incre√≠ble {{ $('When Executed by Another Workflow').item.json.email_cliente }}",
        "emailFormat": "text",
        "text": "=Hola {{ $('When Executed by Another Workflow').item.json.nombre_cliente }}:\n\nNos alegra saber que podemos apoyarte en {{ $('When Executed by Another Workflow').item.json.requerimiento_cliente }}, para tu empresa {{ $('When Executed by Another Workflow').item.json.nombre_empresa }}.\n\nEn breve, un ejecutivo de cuenta se pondr√° en contacto contigo para ofrecerte una consultor√≠a personalizada.\n \nAgradecemos tu inter√©s en Nosotros.\n\nSaludos cordiales.",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        860,
        -340
      ],
      "id": "e2079a92-434e-4c95-af6d-3848210e2fe5",
      "name": "Send email",
      "webhookId": "97242a32-5a95-494c-bcfd-0728e1a3f2bd",
      "credentials": {
        "smtp": {
          "id": "SPffmP9Vo3mOZPMZ",
          "name": "SMTP account edukai"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "info@edukai.consulting",
        "toEmail": "=info@edukai.consulting",
        "subject": "=Nuevo Lead",
        "emailFormat": "text",
        "text": "=Tenemos nuevo Lead\n\nCliente:  {{ $('When Executed by Another Workflow').item.json.nombre_cliente }}\nEmpresa: {{ $('When Executed by Another Workflow').item.json.nombre_empresa }}\n\nRequerimiento: {{ $('When Executed by Another Workflow').item.json.requerimiento_cliente }}\nPropuesta: {{ $('When Executed by Another Workflow').item.json.resumen_propuesta }}\n{{ \"\\n\" }}\nPerfilado de cliente: {{ $('When Executed by Another Workflow').item.json.perfilado_de_cliente }}\n{{ \"\\n\" }}\nEstimaci√≥n Inicial: {{ $json.output.detail_of_estimation }}\n{{ \"\\n\" }}\nValor del Lead: {{ $json.output.value }} USD\nProbablidad de Cierre:  {{ $json.output.propability*100 }} %\n{{ \"\\n\" }}\n\nPodemos contactar al cliente por los siguientes medios\nWhatsapp: {{ $('When Executed by Another Workflow').item.json.telefono_cliente }}\nCorreo: {{ $('When Executed by Another Workflow').item.json.email_cliente }}\n\n",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        880,
        120
      ],
      "id": "f8c24cdf-c7f3-4320-b500-5ebfa0628280",
      "name": "Send email1",
      "webhookId": "97242a32-5a95-494c-bcfd-0728e1a3f2bd",
      "credentials": {
        "smtp": {
          "id": "SPffmP9Vo3mOZPMZ",
          "name": "SMTP account edukai"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4",
          "mode": "list",
          "cachedResultName": "GPT-4"
        },
        "messages": {
          "values": [
            {
              "content": "=datos de la empresa: {{ $('When Executed by Another Workflow').item.json.nombre_empresa }}\npropuesta :  {{ $('When Executed by Another Workflow').item.json.resumen_propuesta }}\nperfil empresa:  {{ $('When Executed by Another Workflow').item.json.perfilado_de_cliente }}\nlead_type: {{ $json.type_lead }}\n"
            },
            {
              "content": "=eres un cotizador de sistemas y proyectos de it y te voy a dar datos de una empresa, un requieriiento de IT  y  el perfil de laempresa, y tu debes estimar tres variables: üìä Al completar el perfilado del usuario, aplica el siguiente modelo de puntuaci√≥n:\n1. Asigna un valor entre 0 y 1 a cada una de estas variables, basado en las respuestas del usuario:‚Ä¢ Claridad del proyecto (valor: claridad)‚Ä¢ Presupuesto estimado (valor: presupuesto)‚Ä¢ Nivel de decisi√≥n o influencia (valor: autoridad)‚Ä¢ Plazo de decisi√≥n o de inicio del proyecto (valor: tiempo)‚Ä¢ Compatibilidad estrat√©gica con Cantera Digital (valor: compatibilidad)\n2. Calcula la probabilidad de cierre con esta f√≥rmula:\nprobabilidad_cierre = (claridad √ó 0.25) + (presupuesto √ó 0.20) + (autoridad √ó 0.20) + (tiempo √ó 0.15) + (compatibilidad √ó 0.20)\n3. Redondea el resultado a dos decimales. Registra este valor como `probabilidad_cierre` en el sistema interno y tambi√©n incl√∫yelo en el formato JSON para `ingreso_teams`.\n4. Genera un valor como HOT_LEAD, WARM_LEAD, COLD_LEAD de acuerdo al parametro de lead_type\nüìå Si alg√∫n valor no puede ser determinado, asigna 0.3 de manera conservadora. Este valor debe actualizarse autom√°ticamente si luego se obtiene m√°s informaci√≥n en la conversaci√≥n.",
              "role": "system"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -100,
        -20
      ],
      "id": "011d60ad-b506-476a-8d21-84027274b790",
      "name": "Message a model",
      "credentials": {
        "openAiApi": {
          "id": "nFhq9424Dw9eFpNq",
          "name": "OpenAi Agente Edukai"
        }
      }
    }
  ],
  "connections": {
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "Message a model",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor": {
      "main": [
        [
          {
            "node": "Send email",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send email1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send email": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model": {
      "main": [
        [
          {
            "node": "Information Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "When Executed by Another Workflow": [
      {
        "json": {
          "nombre_cliente": "Roberto Aaron Avila Valdes",
          "email_cliente": "aaron_avival@hotmail.com",
          "telefono_cliente": "5214432139575",
          "nombre_empresa": "AaronCollections",
          "requerimiento_cliente": "Desarrollo de una p√°gina web e-commerce para vender figuras coleccionables de Funko Pop, sin dise√±o ni equipo t√©cnico actual. Presupuesto aproximado de $10,000. Plazo de entrega finales de julio.",
          "perfilado_de_cliente": "Empleados: 3; Ubicaci√≥n: Morelia, Michoac√°n; Poder de decisi√≥n en la compra.",
          "resumen_propuesta": "Propuesta de desarrollo de p√°gina web e-commerce con dise√±o atractivo y funcionalidad de venta en l√≠nea.",
          "type_lead": "hot"
        }
      }
    ]
  },
  "versionId": "ac70f988-b34f-480e-810f-42c7826730b4",
  "triggerCount": 0,
  "shared": [
    {
      "createdAt": "2025-07-02T00:07:35.916Z",
      "updatedAt": "2025-07-02T00:07:35.916Z",
      "role": "workflow:owner",
      "workflowId": "uXmZvPw4HonDoJtb",
      "projectId": "BZ9Ta5yhe4RhzY78",
      "project": {
        "createdAt": "2025-05-13T15:56:28.209Z",
        "updatedAt": "2025-05-13T16:18:54.372Z",
        "id": "BZ9Ta5yhe4RhzY78",
        "name": "CANTERA ADMIN <canteradigital7@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null,
        "projectRelations": [
          {
            "createdAt": "2025-05-13T15:56:28.209Z",
            "updatedAt": "2025-05-13T15:56:28.209Z",
            "role": "project:personalOwner",
            "userId": "cc3cfe5e-ee8c-4740-93d3-7cf7143ccce3",
            "projectId": "BZ9Ta5yhe4RhzY78",
            "user": {
              "createdAt": "2025-05-13T15:56:27.880Z",
              "updatedAt": "2025-07-08T21:59:22.697Z",
              "id": "cc3cfe5e-ee8c-4740-93d3-7cf7143ccce3",
              "email": "canteradigital7@gmail.com",
              "firstName": "CANTERA",
              "lastName": "ADMIN",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2025-05-13T16:19:25.161Z",
                "personalization_survey_n8n_version": "1.92.2",
                "companySize": "<20",
                "companyType": "saas",
                "role": "customer-support",
                "reportedSource": "event"
              },
              "settings": {
                "userActivated": true,
                "firstSuccessfulWorkflowId": "PTbESRzX3rguwQN8",
                "userActivatedAt": 1747154580970,
                "easyAIWorkflowOnboarded": true,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1748367494893
                },
                "dismissedCallouts": {
                  "aiAgentStarterCallout": true
                }
              },
              "role": "global:owner",
              "disabled": false,
              "mfaEnabled": false,
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [
    {
      "createdAt": "2025-07-01T23:56:34.889Z",
      "updatedAt": "2025-07-01T23:56:34.889Z",
      "id": "jWjb6ND4ue1gFvYO",
      "name": "agente edukai"
    }
  ]
}